%%
%% Author: Clay
%% 2020/2/20
%%

\chapter{异常控制流}
{
    从给处理器加电开始，直到断电为止，程序计数器假设一个值的序列

    \begin{align*}
        a_0, a_1, \cdots, a_{n -1}
    \end{align*}

    其中，每个 $a_k$ 是某个相应的指令 $I_k$ 的地址。
    每次从 $a_k$ 到 $a_{k + 1}$ 的过渡称为\emreg{控制转移(control transfer)}。
    这样的控制转移序列叫做处理器的\emreg{控制流(flow of control 或 control flow)}。

    最简单的控制流是一个平滑的序列，其中每个 $\I_k$ 和 $\I_{k + 1}$ 在内存中都是相邻的。
    这种平滑流的突变通常是由诸如跳转、调用和返回这样一些熟悉的程序指令造成的。
    这样一些指令都是必要的机制，使得程序能够对由程序变量表示的内部程序状态中的变化作出反应。

    但是系统也必须能够对系统状态的变化做出反应。
    这些系统状态不是被内部程序变量捕获的，而且也不一定要和程序的执行相关。

    现代系统通过使控制流发生突变来对这些情况做出反应。
    这些突变称为\emreg{异常控制流(Exceptional Control Flow, ECF)}。
    异常控制流发生在计算机系统的各个层次。

    理解ECF很重要，有很多原因：

    \begin{description}
        \item[理解ECF将帮助你理解重要的系统概念] ECF是操作系统用来实现I/O、进程和虚拟内存的基本机制。
        \item[理解ECF将帮助你理解应用程序是如何与操作系统交互的] 应用程序通过使用一个叫做\emspe{陷阱(trap)}或者\emspe{系统调用(system call)}的ECF形式，向操作系统请求服务。
        \item[理解ECF将帮助你编写有趣的新应用程序] 操作系统为应用程序提供饿了强大的ECF机制，用来创建新进程、等待进程终止、通知其他进程系统中的异常事件，以及检测和响应这些事件。
        \item[理解ECF将帮助你理解并发] ECF是计算机系统中实现并发的基本机制。
        \item[理解ECF将帮助你理解软件异常如何工作] 软件异常允许程序进行\emspe{非本地} 跳转来响应错误情况。
    \end{description}

    \input{section01.tex}
}

\cleardoublepage

\endinput
