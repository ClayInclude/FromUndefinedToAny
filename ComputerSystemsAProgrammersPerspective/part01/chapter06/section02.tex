%%
%% Author: Clay
%% 2020/6/18
%%

\section{局部性}
{
    一个编写良好的计算机程序常常具有良好的\emreg{局部性(locality)}。
    也就是，他们倾向于引用邻近于其他最近引用过的数据项的数据项，或者最近引用过的数据项本身。
    这种倾向性，被称为\emreg{局部性原理(principle of locality)}，是一个持久的概念。

    局部性通常有两种不同的形式：\emreg{时间局部性(temporal locality)}和\emreg{空间局部性(spatial locality)}。

    一般而言，\emreg{有良好局部性的程序比局部性差的程序运行得更快}。
    在硬件层，局部性原理允许计算机设计者通过引入称为\emreg{高速缓存存储器}的小而快速的存储器来保存最近被引用的指令和数据项，从而提高对主存的访问速度。
    在操作系统级，局部性原理允许系统使用主存作为虚拟地址空间最近被引用块的高速缓存。
    类似地，操作系统用主存来缓存磁盘文件系统中最近被使用的磁盘块。
    局部性原理在应用程序的设计中也扮演着重要的角色。

    \subsection{对程序数据引用的局部性}
    {
        顺序访问一个向量每个元素的函数，具有\emreg{步长为1的引用模式(stride-1 reference pattern)}（相对于元素的大小）。
        有时称步长为1的引用模式为\emreg{顺序引用模式(sequential reference pattern)}。
        一个连续向量中，每隔 $k$ 个元素进行访问，就称为\emreg{步长为 $k$ 的引用模式(stride-k reference pattern)}。
        步长为1的引用模式是程序中空间局部性常见和重要的来源。
        一般而言，随着步长的增加，空间局部性下降。

        引用多维数组的程序，嵌套循环按照\emreg{行优先顺序(row major order)}读数组的元素，也具有良好的空间局部性。
        因为它按照数组被存储的行优先顺序来访问数组。
        其结果是得到一个步长为1的引用模式。
    }

    \subsection{取指令的局部性}
    {
        因为程序是存放在内存中的，CPU必须取出这些指令，所以也能够评价一个程序关于取指令的局部性。

        代码区别于程序数据的一个重要属性是在运行时它是不能被修改的。
    }

    \subsection{局部性小结}
    {
        量化评价程序中局部性的一些简单原则：

        \begin{itemize}
            \item 重复引用相同变量的程序有良好的时间局部性。
            \item 对于具有步长 $k$ 的引用模式的程序，步长越小，空间局部性越好。
            \item 对于取指令来说，循环有好的时间和空间局部性。循环体越小，循环迭代次数越多，局部性越好。
        \end{itemize}

        %7.
        \begin{practicec}

        \end{practicec}

        %8.
        \begin{practicec}
            clear1: 3, clear2: 1, clear3: 6
        \end{practicec}
    }
}
